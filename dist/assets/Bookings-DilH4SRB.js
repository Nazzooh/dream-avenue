import{j as e,aa as Ie,ab as $e,ac as qe,i as T,z as te,n as fe,a7 as je,ad as Ue,C as q,o as ne,P as be,u as Ne,U as Ae,w as ze,ae as Ce,X as Re,af as ge,q as Ee,W as he,p as Ge,F as ve,ag as He,ah as we,ai as Oe,V as Ve,t as o}from"./vendor-ui-Bvf1z7Qk.js";import{b as s}from"./vendor-react-DmQ-wajQ.js";import{A as We}from"./AdminLayout-3i5P8tIF.js";import{u as Qe,a as Ye,b as Ke,c as Xe,g as Je,d as Ze,e as er,f as rr}from"./useBookings-BaGahci2.js";import{u as ar}from"./usePackages-B1twxbUE.js";import{m as E,A as se,s as X}from"./index-DCvhesIs.js";import"./MobileBottomNav-B5hhplxL.js";import"./useAuth-BHPREJkW.js";import"./logger-DwKo-Kyg.js";import"./vendor-motion-DcNBMtCR.js";function ke({status:a,className:t=""}){const d=()=>{switch(a.toLowerCase()){case"confirmed":case"completed":case"active":case"success":return"admin-badge-success";case"pending":case"ongoing":return"admin-badge-warning";case"cancelled":case"inactive":case"rejected":return"admin-badge-danger";case"scheduled":case"info":return"admin-badge-info";default:return"admin-badge-neon"}};return e.jsx("span",{className:`admin-badge ${d()} ${t}`,children:a})}function lr(a){const t=a.performed_by_name||a.actor_name||a.performed_by||"Admin";switch(a.action){case"confirmed":case"booking_confirmed":return`${t} confirmed this booking`;case"updated_details":case"details_updated":return`${t} updated booking details`;case"updated_pricing":case"pricing_updated":return`${t} updated pricing`;case"cancelled":case"booking_cancelled":return`${t} cancelled this booking`;case"extras_updated":return`${t} updated extras`;case"completed":case"booking_completed":return`${t} marked booking as completed`;case"reopened":case"booking_reopened":return`${t} reopened this booking`;case"created":case"booking_created":return`${t} created this booking`;default:const d=a.action.replace(/_/g," ");return`${t} ${d}`}}function hr(){const[a,t]=s.useState(null),[d,i]=s.useState(!1),[g,v]=s.useState(!1),[w,n]=s.useState(!1),[k,D]=s.useState(null),[B,F]=s.useState(null),[p,J]=s.useState("all"),[u,U]=s.useState(""),[z,Z]=s.useState("list"),{data:y=[],isLoading:R,refetch:P}=Qe(),ee=Ye(),_=Ke(),G=Xe(),x=s.useMemo(()=>{let l=y;if(p!=="all"&&(l=l.filter(c=>c.status===p)),u.trim()){const c=u.toLowerCase();l=l.filter(h=>h.full_name.toLowerCase().includes(c)||h.mobile.includes(c)||h.email&&h.email.toLowerCase().includes(c))}return l},[y,p,u]),j=s.useMemo(()=>({total:y.length,pending:y.filter(l=>l.status==="pending").length,confirmed:y.filter(l=>l.status==="confirmed").length,completed:y.filter(l=>l.status==="completed").length,cancelled:y.filter(l=>l.status==="cancelled").length}),[y]),N=l=>{t(l),i(!0)},S=l=>{D(l),v(!0)},A=async()=>{if(k)try{await ee.mutateAsync(k.id),v(!1),D(null),o.success(e.jsxs("div",{children:[e.jsx("strong",{children:"Booking Cancelled"}),e.jsx("p",{style:{fontSize:"0.875rem",marginTop:"4px",opacity:.9},children:"âœ“ Date automatically released to calendar"})]}),{duration:4e3})}catch(l){console.error("Cancel error:",l)}},M=l=>{F(l),n(!0)},H=async()=>{if(B)try{await _.mutateAsync(B.id),n(!1),F(null),i(!1),o.success(e.jsxs("div",{children:[e.jsx("strong",{children:"Booking Deleted"}),e.jsx("p",{style:{fontSize:"0.875rem",marginTop:"4px",opacity:.9},children:"âœ“ Record removed & date freed automatically"})]}),{duration:4e3})}catch(l){console.error("Delete error:",l)}},re=async(l,c)=>{try{console.log("ðŸ”„ Updating booking status:",{bookingId:l,status:c}),await G.mutateAsync({id:l,status:c}),i(!1),t(null),c==="confirmed"?o.success(e.jsxs("div",{children:[e.jsx("strong",{children:"Booking Confirmed!"}),e.jsx("p",{style:{fontSize:"0.875rem",marginTop:"4px",opacity:.9},children:"âœ“ Date automatically blocked in calendar"})]}),{duration:4e3}):c==="completed"&&o.success(e.jsxs("div",{children:[e.jsx("strong",{children:"Event Completed"}),e.jsx("p",{style:{fontSize:"0.875rem",marginTop:"4px",opacity:.9},children:"âœ“ Date freed for new bookings"})]}),{duration:4e3})}catch(h){console.error("âŒ Status update error:",h),o.error("Failed to update booking status. Please try again.")}},b=l=>{switch(l){case"confirmed":return"success";case"pending":return"warning";case"cancelled":return"danger";case"completed":return"success";default:return"neutral"}},C=l=>new Date(l).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}),O=l=>{if(!l)return"N/A";const[c,h]=l.split(":"),L=parseInt(c),Q=L>=12?"PM":"AM";return`${L%12||12}:${h} ${Q}`},V=l=>(console.log("ðŸ” formatEventType called with:",l),l?l.replace(/_/g," ").split(" ").map(c=>c.charAt(0).toUpperCase()+c.slice(1).toLowerCase()).join(" "):"Not specified"),W=l=>l?{morning:"Morning",evening:"Evening",night:"Night",full_day:"Full Day",short_duration:"Short Duration (4-5 hours)"}[l]||l:"Not selected";return e.jsxs(We,{children:[e.jsx("div",{className:"min-h-screen",style:{background:"linear-gradient(135deg, #FAF9F6 0%, #F5F3EE 100%)"},children:e.jsxs("div",{className:"w-full max-w-[1600px] mx-auto px-[4%] sm:px-[5%] lg:px-[6%] xl:px-[8%] py-[clamp(1.5rem,4vw,3rem)]",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-[clamp(1rem,2.5vw,1.5rem)] mb-[clamp(1.5rem,3vw,2rem)]",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-[clamp(1.75rem,4vw,2.5rem)] leading-tight mb-[0.5em]",style:{color:"#2A2A2A"},children:"Booking Management"}),e.jsx("p",{className:"text-[clamp(0.875rem,1.5vw,1rem)]",style:{color:"#666"},children:"Manage event bookings and track venue occupancy"})]}),e.jsxs("div",{className:"flex flex-wrap gap-[clamp(0.5rem,1.5vw,0.75rem)]",children:[e.jsxs("button",{onClick:()=>P(),className:"px-[clamp(0.75rem,2vw,1rem)] py-[clamp(0.5rem,1.5vw,0.625rem)] rounded-xl transition-all duration-200 flex items-center gap-2 text-[clamp(0.875rem,1.5vw,1rem)]",style:{background:"white",border:"2px solid #E8E5DB",color:"#666",boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},onMouseEnter:l=>{l.currentTarget.style.borderColor="#C8D46B",l.currentTarget.style.color="#2A2A2A"},onMouseLeave:l=>{l.currentTarget.style.borderColor="#E8E5DB",l.currentTarget.style.color="#666"},children:[e.jsx(Ie,{className:"w-[1em] h-[1em]"}),e.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]}),e.jsxs("button",{className:"px-[clamp(0.75rem,2vw,1rem)] py-[clamp(0.5rem,1.5vw,0.625rem)] rounded-xl transition-all duration-200 flex items-center gap-2 text-[clamp(0.875rem,1.5vw,1rem)]",style:{background:"linear-gradient(135deg, #C8D46B, #B5C55A)",border:"none",color:"white",boxShadow:"0 4px 12px rgba(200, 212, 107, 0.3)"},children:[e.jsx($e,{className:"w-[1em] h-[1em]"}),e.jsx("span",{className:"hidden sm:inline",children:"Export"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-[clamp(0.75rem,2vw,1rem)] mb-[clamp(1.5rem,3vw,2rem)]",children:[e.jsx($,{label:"Total Bookings",value:j.total,icon:e.jsx(qe,{className:"w-[1em] h-[1em]"}),color:"#C8D46B",delay:0}),e.jsx($,{label:"Pending",value:j.pending,icon:e.jsx(T,{className:"w-[1em] h-[1em]"}),color:"#F4B942",delay:.1}),e.jsx($,{label:"Confirmed",value:j.confirmed,icon:e.jsx(te,{className:"w-[1em] h-[1em]"}),color:"#4CAF50",delay:.2}),e.jsx($,{label:"Completed",value:j.completed,icon:e.jsx(fe,{className:"w-[1em] h-[1em]"}),color:"#E0C097",delay:.3}),e.jsx($,{label:"Cancelled",value:j.cancelled,icon:e.jsx(je,{className:"w-[1em] h-[1em]"}),color:"#E57373",delay:.4})]}),e.jsxs("div",{className:"flex flex-col xl:flex-row gap-[clamp(0.75rem,2vw,1rem)] mb-[clamp(1.5rem,3vw,2rem)]",children:[e.jsxs("div",{className:"flex-1 min-w-0 relative",children:[e.jsx(Ue,{className:"absolute left-[clamp(0.75rem,2vw,1rem)] top-1/2 -translate-y-1/2 w-[clamp(1rem,1.5vw,1.25rem)] h-[clamp(1rem,1.5vw,1.25rem)]",style:{color:"#999"}}),e.jsx("input",{type:"text",placeholder:"Search by name, phone, or email...",value:u,onChange:l=>U(l.target.value),className:"w-full pl-[clamp(2.5rem,6vw,3rem)] pr-[clamp(0.75rem,2vw,1rem)] py-[clamp(0.625rem,1.5vw,0.75rem)] rounded-xl transition-all duration-200 text-[clamp(0.875rem,1.5vw,1rem)]",style:{background:"white",border:"2px solid #E8E5DB",color:"#2A2A2A",outline:"none"},onFocus:l=>{l.currentTarget.style.borderColor="#C8D46B",l.currentTarget.style.boxShadow="0 4px 12px rgba(200, 212, 107, 0.15)"},onBlur:l=>{l.currentTarget.style.borderColor="#E8E5DB",l.currentTarget.style.boxShadow="none"}})]}),e.jsx("div",{className:"flex gap-[clamp(0.5rem,1.5vw,0.75rem)] flex-wrap",children:[{value:"all",label:"All",color:"#666"},{value:"pending",label:"Pending",color:"#F4B942"},{value:"confirmed",label:"Confirmed",color:"#4CAF50"},{value:"completed",label:"Completed",color:"#E0C097"},{value:"cancelled",label:"Cancelled",color:"#E57373"}].map(l=>e.jsxs("button",{onClick:()=>J(l.value),className:"px-[clamp(0.75rem,2vw,1rem)] py-[clamp(0.5rem,1.5vw,0.625rem)] rounded-xl transition-all duration-200 capitalize text-[clamp(0.75rem,1.5vw,0.875rem)] whitespace-nowrap",style:{background:p===l.value?l.color:"white",color:p===l.value?"white":"#666",border:`2px solid ${p===l.value?l.color:"#E8E5DB"}`,boxShadow:p===l.value?`0 4px 12px ${l.color}40`:"0 2px 4px rgba(0,0,0,0.02)"},children:[l.label,l.value!=="all"&&e.jsx("span",{className:"ml-[0.5em] px-[0.5em] py-[0.125em] rounded-full text-[0.75em]",style:{background:p===l.value?"rgba(255,255,255,0.3)":"rgba(0,0,0,0.05)"},children:j[l.value]})]},l.value))})]}),R?e.jsx("div",{className:"flex items-center justify-center py-[clamp(3rem,10vw,5rem)]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(E.div,{animate:{rotate:[0,360]},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-[clamp(3rem,8vw,4rem)] h-[clamp(3rem,8vw,4rem)] mx-auto mb-[1em] rounded-full border-4 border-t-transparent",style:{borderColor:"#C8D46B",borderTopColor:"transparent"}}),e.jsx("p",{className:"text-[clamp(0.875rem,1.5vw,1rem)]",style:{color:"#666"},children:"Loading bookings..."})]})}):x.length===0?e.jsxs("div",{className:"text-center py-[clamp(3rem,10vw,5rem)]",children:[e.jsx("div",{className:"w-[clamp(4rem,10vw,5rem)] h-[clamp(4rem,10vw,5rem)] mx-auto mb-[1.5em] rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, rgba(200, 212, 107, 0.1), rgba(181, 197, 90, 0.05))"},children:e.jsx(q,{className:"w-[50%] h-[50%]",style:{color:"#C8D46B"}})}),e.jsx("h3",{className:"text-[clamp(1.25rem,2.5vw,1.5rem)] mb-[0.5em]",style:{color:"#2A2A2A"},children:u?"No matching bookings found":`No ${p!=="all"?p:""} bookings`}),e.jsx("p",{className:"text-[clamp(0.875rem,1.5vw,1rem)]",style:{color:"#999"},children:u?"Try adjusting your search terms":"Bookings will appear here as they are created"})]}):e.jsx("div",{className:"space-y-[clamp(0.75rem,2vw,1rem)]",children:x.map((l,c)=>e.jsx(sr,{booking:l,onView:N,onCancel:S,formatDate:C,formatTime:O,getStatusVariant:b,delay:c*.05},l.id))})]})}),e.jsx(se,{children:d&&a&&e.jsx(tr,{booking:a,onClose:()=>{i(!1),t(null)},onStatusUpdate:re,onCancel:S,onDelete:M,formatDate:C,formatTime:O,formatEventType:V,formatTimeSlot:W,getStatusVariant:b,updateStatusMutation:G,refetchBookings:P})}),e.jsx(se,{children:g&&k&&e.jsx(ye,{title:"Cancel Booking",message:`Are you sure you want to cancel the booking for ${k.full_name}? The date will be automatically released in the calendar.`,confirmText:"Yes, Cancel Booking",cancelText:"Keep Booking",onConfirm:A,onCancel:()=>{v(!1),D(null)},isDangerous:!0})}),e.jsx(se,{children:w&&B&&e.jsx(ye,{title:"Delete Booking",message:"Are you sure you want to permanently delete this booking? This action cannot be undone.",confirmText:"Yes, Delete Permanently",cancelText:"Cancel",onConfirm:H,onCancel:()=>{n(!1),F(null)},isDangerous:!0})})]})}function $({label:a,value:t,icon:d,color:i,delay:g}){return e.jsxs(E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:g},className:"p-[clamp(0.75rem,2.5vw,1.25rem)] rounded-2xl relative overflow-hidden",style:{background:"white",border:"2px solid #E8E5DB",boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},children:[e.jsx("div",{className:"absolute top-0 right-0 opacity-10",style:{background:i,width:"clamp(4rem,20vw,6rem)",height:"clamp(4rem,20vw,6rem)",marginRight:"calc(clamp(4rem,20vw,6rem) * -0.33)",marginTop:"calc(clamp(4rem,20vw,6rem) * -0.33)",borderRadius:"50%"}}),e.jsx("div",{className:"flex items-center gap-[0.75em] mb-[0.75em]",children:e.jsx("div",{className:"rounded-xl flex items-center justify-center text-[clamp(1rem,2vw,1.25rem)]",style:{background:`${i}20`,color:i,width:"2.5em",height:"2.5em"},children:d})}),e.jsx("div",{className:"text-[clamp(1.75rem,4vw,2.5rem)] leading-none mb-[0.25em]",style:{color:"#2A2A2A"},children:t}),e.jsx("div",{className:"text-[clamp(0.75rem,1.5vw,0.875rem)]",style:{color:"#999"},children:a})]})}function sr({booking:a,onView:t,onCancel:d,formatDate:i,formatTime:g,getStatusVariant:v,delay:w}){return e.jsx(E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:w},className:"p-[clamp(0.75rem,2.5vw,1.5rem)] rounded-2xl transition-all duration-200 cursor-pointer",style:{background:"white",border:"2px solid #E8E5DB",boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},onClick:()=>t(a),onMouseEnter:n=>{n.currentTarget.style.borderColor="#C8D46B",n.currentTarget.style.boxShadow="0 8px 24px rgba(200, 212, 107, 0.15)",n.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:n=>{n.currentTarget.style.borderColor="#E8E5DB",n.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.04)",n.currentTarget.style.transform="translateY(0)"},children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center gap-[clamp(0.75rem,2vw,1rem)]",children:[e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-center gap-[clamp(0.5rem,1.5vw,0.75rem)] mb-[0.75em]",children:[e.jsx("div",{className:"rounded-full flex items-center justify-center flex-shrink-0 text-[clamp(0.875rem,1.5vw,1rem)]",style:{background:"linear-gradient(135deg, #C8D46B, #B5C55A)",color:"white",width:"3em",height:"3em"},children:e.jsx(ne,{className:"w-[1.5em] h-[1.5em]"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"text-[clamp(1rem,2vw,1.25rem)] leading-tight mb-[0.25em] truncate",style:{color:"#2A2A2A"},children:a.full_name}),e.jsxs("div",{className:"flex flex-wrap items-center gap-[0.75em] text-[clamp(0.75rem,1.5vw,0.875rem)]",style:{color:"#666"},children:[e.jsxs("div",{className:"flex items-center gap-[0.25em]",children:[e.jsx(be,{className:"w-[1em] h-[1em]"}),a.mobile]}),a.email&&e.jsxs("div",{className:"flex items-center gap-[0.25em] min-w-0",children:[e.jsx(Ne,{className:"w-[1em] h-[1em]"}),e.jsx("span",{className:"truncate",children:a.email})]})]})]})]})}),e.jsxs("div",{className:"flex flex-wrap gap-x-[clamp(1rem,3vw,1.5rem)] gap-y-[0.75em] text-[clamp(0.75rem,1.5vw,0.875rem)]",children:[e.jsxs("div",{className:"min-w-[120px]",children:[e.jsx("div",{className:"text-[0.85em] mb-[0.25em]",style:{color:"#999"},children:"Event Date"}),e.jsxs("div",{className:"flex items-center gap-[0.5em]",style:{color:"#2A2A2A"},children:[e.jsx(q,{className:"w-[1em] h-[1em]"}),i(a.booking_date)]})]}),e.jsxs("div",{className:"min-w-[100px]",children:[e.jsx("div",{className:"text-[0.85em] mb-[0.25em]",style:{color:"#999"},children:"Time"}),e.jsxs("div",{className:"flex items-center gap-[0.5em]",style:{color:"#2A2A2A"},children:[e.jsx(T,{className:"w-[1em] h-[1em]"}),g(a.start_time)]})]}),a.guest_count&&e.jsxs("div",{className:"min-w-[80px]",children:[e.jsx("div",{className:"text-[0.85em] mb-[0.25em]",style:{color:"#999"},children:"Guests"}),e.jsxs("div",{className:"flex items-center gap-[0.5em]",style:{color:"#2A2A2A"},children:[e.jsx(Ae,{className:"w-[1em] h-[1em]"}),a.guest_count]})]})]}),e.jsxs("div",{className:"flex items-center gap-[clamp(0.5rem,1.5vw,0.75rem)] lg:pl-[clamp(0.75rem,2vw,1rem)] lg:border-l-2",style:{borderColor:"#E8E5DB"},children:[e.jsx(ke,{status:a.status,variant:v(a.status)}),e.jsx("button",{onClick:n=>{n.stopPropagation(),t(a)},className:"rounded-xl transition-all duration-200 text-[clamp(0.875rem,1.5vw,1rem)]",style:{background:"linear-gradient(135deg, #C8D46B, #B5C55A)",color:"white",padding:"clamp(0.5rem,1.5vw,0.625rem)"},children:e.jsx(ze,{className:"w-[1em] h-[1em]"})}),a.status==="confirmed"&&e.jsx("button",{onClick:n=>{n.stopPropagation(),d(a)},className:"rounded-xl transition-all duration-200 text-[clamp(0.875rem,1.5vw,1rem)]",style:{background:"white",border:"2px solid #E57373",color:"#E57373",padding:"clamp(0.5rem,1.5vw,0.625rem)"},onMouseEnter:n=>{n.currentTarget.style.background="#E57373",n.currentTarget.style.color="white"},onMouseLeave:n=>{n.currentTarget.style.background="white",n.currentTarget.style.color="#E57373"},children:e.jsx(Ce,{className:"w-[1em] h-[1em]"})})]})]})})}function tr({booking:a,onClose:t,onStatusUpdate:d,onCancel:i,onDelete:g,formatDate:v,formatTime:w,formatEventType:n,formatTimeSlot:k,getStatusVariant:D,updateStatusMutation:B,refetchBookings:F}){console.log("ðŸ“‹ BookingDetailsModal - booking data:",{id:a.id,event_type:a.event_type,time_slot:a.time_slot,package_id:a.package_id,special_requests:a.special_requests});const[p,J]=s.useState(a.admin_notes||""),[u,U]=s.useState(!1),[z,Z]=s.useState(null),[y,R]=s.useState(!1),[P,ee]=s.useState(a.event_type||"normal"),[_,G]=s.useState(a.package_id||""),[x,j]=s.useState(a.time_slot||"full_day"),[N,S]=s.useState(a.start_time||""),[A,M]=s.useState(a.end_time||""),[H,re]=s.useState(a.admin_price_adjustment||0),[b,C]=s.useState(!1),[O,V]=s.useState(!1),[W,l]=s.useState(""),[c,h]=s.useState(a.garbage_bags||0),[L,Q]=s.useState(a.plates_small||0),[ae,ce]=s.useState(a.plates_large||0),[ie,oe]=s.useState(a.cooking_gas_qty||0),[I,me]=s.useState(!1),[Be,de]=s.useState(0),[pe,_e]=s.useState([]),[Se,xe]=s.useState(!1),[le,Te]=s.useState(!1),{data:ue=[]}=ar();s.useEffect(()=>{a.package_id&&(R(!0),X.from("packages").select("*").eq("id",a.package_id).single().then(({data:r,error:m})=>{r&&Z(r),m&&console.error("Failed to load package:",m)}).finally(()=>R(!1)))},[a.package_id]),s.useEffect(()=>{(async()=>{if(a.id){xe(!0);try{const m=await Je(a.id);_e(m)}catch(m){console.error("Failed to load booking actions:",m)}finally{xe(!1)}}})()},[a.id]),s.useEffect(()=>{x!=="short_duration"?(S(""),M("")):x==="short_duration"&&!N&&!A&&(S("10:00"),M("18:00"))},[x]);const De=async()=>{try{const{data:{session:r}}=await X.auth.getSession();if(!r?.user?.id){o.error("Admin session not found. Please log in again.");return}const m=r.user.id;console.log("ðŸ”„ Confirming booking:",{bookingId:a.id,adminId:m}),await rr({bookingId:a.id,adminId:m}),o.success(e.jsxs("div",{children:[e.jsx("strong",{children:"Booking Confirmed!"}),e.jsx("p",{style:{fontSize:"0.875rem",marginTop:"4px",opacity:.9},children:"âœ“ Date automatically blocked in calendar"})]}),{duration:4e3}),F(),t()}catch(r){console.error("âŒ Confirm booking failed:",r),o.error(r.message||"Failed to confirm booking. Please try again.")}},Fe=async()=>{if(a.id){U(!0);try{const{error:r}=await X.from("bookings").update({admin_notes:p}).eq("id",a.id);r?(console.error("Failed to save admin notes:",r),o.error("Error saving notes")):(o.success("Admin notes updated successfully"),a.admin_notes=p)}catch(r){console.error("Error saving admin notes:",r),o.error("Error saving notes")}finally{U(!1)}}},Pe=async()=>{if(a.id){me(!0);try{const r=await er(a.id,{garbage_bags:c,plates_small:L,plates_large:ae,cooking_gas_qty:ie});o.success("Extra services updated successfully"),console.log("Updated booking data from server:",{garbage_bags:r.garbage_bags,garbage_cost:r.garbage_cost,plates_small:r.plates_small,plates_large:r.plates_large,plates_cost:r.plates_cost,cooking_gas_qty:r.cooking_gas_qty,cooking_gas_cost:r.cooking_gas_cost,extra_services_total:r.extra_services_total,final_price:r.final_price}),console.log("Updated booking data from server:",{garbage_bags:r.garbage_bags,garbage_cost:r.garbage_cost,plates_small:r.plates_small,plates_large:r.plates_large,plates_cost:r.plates_cost,cooking_gas_qty:r.cooking_gas_qty,cooking_gas_cost:r.cooking_gas_cost,extra_services_total:r.extra_services_total,final_price:r.final_price}),Object.assign(a,r),h(r.garbage_bags||0),Q(r.plates_small||0),ce(r.plates_large||0),oe(r.cooking_gas_qty||0),de(m=>m+1)}catch(r){console.error("Error saving extra services:",r),o.error(r.message||"Error saving extra services")}finally{me(!1)}}},Me=async()=>{if(a.id){if(x!=="short_duration"&&(N||A)){l("Start and end times are only allowed for short duration bookings"),o.error("Start and end times are only allowed for short duration bookings");return}if(x==="short_duration"&&(!N||!A)){l("Start and end times are required for short duration bookings"),o.error("Start and end times are required for short duration bookings");return}l(""),C(!0);try{const{data:{session:r}}=await X.auth.getSession();if(!r?.user?.id){o.error("Admin session not found. Please log in again."),C(!1);return}const m=await Ze({bookingId:a.id,eventType:P,packageId:_||null,timeSlot:x,startTime:x==="short_duration"&&N||null,endTime:x==="short_duration"&&A||null,adminPriceAdjustment:H,specialRequests:a.special_requests||null,adminId:r.user.id});if(!m){console.error("No updated booking returned from RPC"),C(!1);return}const Y=m;if(o.success(e.jsxs("div",{children:[e.jsx("strong",{children:"Booking Updated Successfully"}),e.jsxs("p",{style:{fontSize:"0.875rem",marginTop:"4px",opacity:.9},children:["âœ“ Price recalculated by server | â‚¹",Y.final_price?.toLocaleString()]})]}),{duration:4e3}),Object.assign(a,Y),_){const K=ue.find(Le=>Le.id===_);K&&Z(K)}V(!1),de(K=>K+1),window.location.reload()}catch(r){console.error("Error saving booking edits:",r),o.error(r.message||"Error saving booking edits")}finally{C(!1)}}};return e.jsx(E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 flex items-center justify-center",style:{background:"rgba(0, 0, 0, 0.6)",backdropFilter:"blur(8px)",zIndex:9999,padding:"clamp(0.75rem,3vw,1.5rem)"},onClick:t,children:e.jsxs(E.div,{initial:{scale:.95,y:20},animate:{scale:1,y:0},exit:{scale:.95,y:20},className:"rounded-3xl overflow-hidden flex flex-col",style:{background:"white",boxShadow:"0 20px 60px rgba(0,0,0,0.3)",width:"100%",maxWidth:"min(56rem, 95vw)",maxHeight:"min(90vh, 1000px)",margin:"0 auto"},onClick:r=>r.stopPropagation(),children:[e.jsxs("div",{className:"border-b-2 flex items-center justify-between",style:{borderColor:"#E8E5DB",background:"linear-gradient(135deg, #FAF9F6 0%, #F5F3EE 100%)",padding:"clamp(0.75rem,2.5vw,1.5rem) clamp(1rem,4vw,2rem)"},children:[e.jsxs("div",{className:"flex items-center gap-[clamp(0.5rem,2vw,1rem)] min-w-0 flex-1",children:[e.jsx("div",{className:"rounded-2xl flex items-center justify-center flex-shrink-0",style:{background:"linear-gradient(135deg, #C8D46B, #B5C55A)",color:"white",width:"clamp(3rem,8vw,3.5rem)",height:"clamp(3rem,8vw,3.5rem)"},children:e.jsx(q,{style:{width:"45%",height:"45%"}})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h2",{className:"text-[clamp(1.25rem,3vw,1.75rem)] leading-tight mb-[0.25em] truncate",style:{color:"#2A2A2A"},children:"Booking Details"}),e.jsxs("p",{className:"text-[clamp(0.75rem,1.5vw,0.875rem)] truncate",style:{color:"#999"},children:["ID: ",a.id?.substring(0,8),"..."]})]})]}),e.jsx("button",{onClick:t,className:"rounded-xl transition-all duration-200 hover:scale-110 flex-shrink-0 ml-[clamp(0.5rem,2vw,1rem)]",style:{background:"white",border:"2px solid #E8E5DB",color:"#666",padding:"clamp(0.5rem,1.5vw,0.75rem)"},onMouseEnter:r=>{r.currentTarget.style.background="#E57373",r.currentTarget.style.borderColor="#E57373",r.currentTarget.style.color="white"},onMouseLeave:r=>{r.currentTarget.style.background="white",r.currentTarget.style.borderColor="#E8E5DB",r.currentTarget.style.color="#666"},children:e.jsx(Re,{style:{width:"clamp(1.25rem,3vw,1.5rem)",height:"clamp(1.25rem,3vw,1.5rem)"}})})]}),e.jsx("div",{className:"overflow-y-auto flex-1",style:{padding:"clamp(1rem,3vw,2rem) clamp(1rem,4vw,2rem)"},children:e.jsxs("div",{style:{display:"grid",gap:"clamp(1.5rem,3vw,2rem)"},children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-[clamp(0.5rem,1.5vw,0.75rem)]",children:[e.jsx(ke,{status:a.status,variant:D(a.status)}),e.jsxs("div",{className:"text-[clamp(0.75rem,1.5vw,0.875rem)]",style:{color:"#999"},children:["Created: ",new Date(a.created_at||"").toLocaleDateString()]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-[clamp(0.5rem,1.5vw,0.75rem)] mb-[clamp(0.75rem,2vw,1.25rem)]",children:[e.jsx("div",{className:"rounded-xl flex items-center justify-center flex-shrink-0",style:{background:"#2196F320",color:"#2196F3",width:"clamp(2.25rem,6vw,2.5rem)",height:"clamp(2.25rem,6vw,2.5rem)"},children:e.jsx(ge,{style:{width:"45%",height:"45%"}})}),e.jsx("h3",{className:"uppercase tracking-wider text-[clamp(0.875rem,2vw,1.125rem)]",style:{color:"#2A2A2A"},children:"Edit Booking Details (Admin)"})]}),e.jsx("div",{className:"rounded-2xl border-2",style:{background:"#FAF9F6",borderColor:"#E8E5DB",padding:"clamp(0.75rem,2.5vw,1.5rem)"},children:e.jsxs("div",{style:{display:"grid",gap:"clamp(0.75rem,2vw,1rem)"},children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-[0.5em] text-[clamp(0.75rem,1.5vw,0.875rem)]",style:{color:"#666"},children:"Event Type"}),e.jsxs("select",{value:P,onChange:r=>ee(r.target.value),className:"w-full rounded-xl transition-all duration-200 text-[clamp(0.875rem,1.5vw,1rem)]",style:{background:"white",border:"2px solid #E8E5DB",color:"#2A2A2A",outline:"none",padding:"clamp(0.5rem,1.5vw,0.75rem) clamp(0.75rem,2vw,1rem)"},children:[e.jsx("option",{value:"birthday",children:"Birthday Party"}),e.jsx("option",{value:"meeting_conference",children:"Meeting / Conference"}),e.jsx("option",{value:"get_together",children:"Get Together"}),e.jsx("option",{value:"awareness_class",children:"Awareness Class"}),e.jsx("option",{value:"normal",children:"Wedding/Reception"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-[0.5em] text-[clamp(0.75rem,1.5vw,0.875rem)]",style:{color:"#666"},children:"Package"}),e.jsxs("select",{value:_,onChange:r=>{G(r.target.value),V(!0)},className:"w-full rounded-xl transition-all duration-200 text-[clamp(0.875rem,1.5vw,1rem)]",style:{background:"white",border:"2px solid #E8E5DB",color:"#2A2A2A",outline:"none",padding:"clamp(0.5rem,1.5vw,0.75rem) clamp(0.75rem,2vw,1rem)"},children:[e.jsx("option",{value:"",children:"Select a package..."}),ue.map(r=>e.jsxs("option",{value:r.id,children:[r.name," - â‚¹",r.price?.toLocaleString()]},r.id))]}),O&&e.jsx("p",{className:"mt-2 text-[clamp(0.75rem,1.5vw,0.875rem)] italic",style:{color:"#F4B942"},children:"âš  Package changed â€” price will be recalculated on save"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-[0.5em] text-[clamp(0.75rem,1.5vw,0.875rem)]",style:{color:"#666"},children:"Time Slot"}),e.jsxs("select",{value:x,onChange:r=>j(r.target.value),className:"w-full rounded-xl transition-all duration-200 text-[clamp(0.875rem,1.5vw,1rem)]",style:{background:"white",border:"2px solid #E8E5DB",color:"#2A2A2A",outline:"none",padding:"clamp(0.5rem,1.5vw,0.75rem) clamp(0.75rem,2vw,1rem)"},children:[e.jsx("option",{value:"morning",children:"Morning"}),e.jsx("option",{value:"evening",children:"Evening"}),e.jsx("option",{value:"night",children:"Night"}),e.jsx("option",{value:"full_day",children:"Full Day"}),e.jsx("option",{value:"short_duration",children:"Short Duration (4-5 hours)"})]})]}),x==="short_duration"&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"clamp(0.75rem,2vw,1rem)"},children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-[0.5em] text-[clamp(0.75rem,1.5vw,0.875rem)]",style:{color:"#666"},children:"Start Time"}),e.jsx("input",{type:"time",value:N,onChange:r=>S(r.target.value),className:"w-full rounded-xl transition-all duration-200 text-[clamp(0.875rem,1.5vw,1rem)]",style:{background:"white",border:"2px solid #E8E5DB",color:"#2A2A2A",outline:"none",padding:"clamp(0.5rem,1.5vw,0.75rem) clamp(0.75rem,2vw,1rem)"}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-[0.5em] text-[clamp(0.75rem,1.5vw,0.875rem)]",style:{color:"#666"},children:"End Time"}),e.jsx("input",{type:"time",value:A,onChange:r=>M(r.target.value),className:"w-full rounded-xl transition-all duration-200 text-[clamp(0.875rem,1.5vw,1rem)]",style:{background:"white",border:"2px solid #E8E5DB",color:"#2A2A2A",outline:"none",padding:"clamp(0.5rem,1.5vw,0.75rem) clamp(0.75rem,2vw,1rem)"}})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-[0.5em] text-[clamp(0.75rem,1.5vw,0.875rem)]",style:{color:"#666"},children:"Admin Adjustment (applied on top)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-[clamp(0.75rem,2vw,1rem)] top-1/2 -translate-y-1/2 text-[clamp(0.875rem,1.5vw,1rem)]",style:{color:"#999"},children:"â‚¹"}),e.jsx("input",{type:"number",step:"100",value:H,onChange:r=>re(parseFloat(r.target.value)||0),className:"w-full rounded-xl transition-all duration-200 text-[clamp(0.875rem,1.5vw,1rem)]",style:{background:"white",border:"2px solid #E8E5DB",color:"#2A2A2A",outline:"none",padding:"clamp(0.5rem,1.5vw,0.75rem) clamp(0.75rem,2vw,1rem)",paddingLeft:"clamp(2rem,4vw,2.5rem)"}})]}),e.jsx("p",{className:"mt-1 text-[clamp(0.625rem,1.25vw,0.75rem)]",style:{color:"#999",fontStyle:"italic"},children:"Can be positive or negative. Leave at 0 for no adjustment."})]}),W&&e.jsxs("div",{className:"rounded-xl p-[clamp(0.75rem,2vw,1rem)] flex items-center gap-[0.5em] text-[clamp(0.75rem,1.5vw,0.875rem)]",style:{background:"#FEE2E2",color:"#DC2626"},children:[e.jsx(Ee,{className:"w-[1em] h-[1em] flex-shrink-0"}),W]}),e.jsx("div",{className:"flex justify-end gap-[clamp(0.5rem,1.5vw,0.75rem)] pt-[clamp(0.5rem,1.5vw,0.75rem)]",style:{borderTop:"2px solid #E8E5DB"},children:e.jsxs("button",{onClick:Me,disabled:b,className:"rounded-xl transition-all duration-200 flex items-center gap-[0.5em] disabled:opacity-50 text-[clamp(0.875rem,1.5vw,1rem)]",style:{background:b?"#E8E5DB":"linear-gradient(135deg, #2196F3, #1976D2)",color:b?"#666":"white",boxShadow:b?"none":"0 4px 12px rgba(33, 150, 243, 0.3)",padding:"clamp(0.625rem,1.5vw,0.75rem) clamp(1rem,2.5vw,1.5rem)"},children:[e.jsx(ge,{className:"w-[1em] h-[1em]"}),b?"Saving...":"Save Booking Edits"]})})]})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-[clamp(0.5rem,1.5vw,0.75rem)] mb-[clamp(0.75rem,2vw,1.25rem)]",children:[e.jsx("div",{className:"rounded-xl flex items-center justify-center flex-shrink-0",style:{background:"#C8D46B20",color:"#C8D46B",width:"clamp(2.25rem,6vw,2.5rem)",height:"clamp(2.25rem,6vw,2.5rem)"},children:e.jsx(ne,{style:{width:"45%",height:"45%"}})}),e.jsx("h3",{className:"uppercase tracking-wider text-[clamp(0.875rem,2vw,1.125rem)]",style:{color:"#2A2A2A"},children:"Client Information"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(min(100%, 250px), 1fr))",gap:"clamp(0.75rem,2vw,1rem)"},children:[e.jsx(f,{icon:e.jsx(ne,{style:{width:"1em",height:"1em"}}),label:"Full Name",value:a.full_name,color:"#C8D46B"}),e.jsx(f,{icon:e.jsx(be,{style:{width:"1em",height:"1em"}}),label:"Mobile Number",value:a.mobile,color:"#E0C097"}),a.email&&e.jsx(f,{icon:e.jsx(Ne,{style:{width:"1em",height:"1em"}}),label:"Email Address",value:a.email,color:"#B5C55A",span:"md:col-span-2"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-[clamp(0.5rem,1.5vw,0.75rem)] mb-[clamp(0.75rem,2vw,1.25rem)]",children:[e.jsx("div",{className:"rounded-xl flex items-center justify-center flex-shrink-0",style:{background:"#4CAF5020",color:"#4CAF50",width:"clamp(2.25rem,6vw,2.5rem)",height:"clamp(2.25rem,6vw,2.5rem)"},children:e.jsx(q,{style:{width:"45%",height:"45%"}})}),e.jsx("h3",{className:"uppercase tracking-wider text-[clamp(0.875rem,2vw,1.125rem)]",style:{color:"#2A2A2A"},children:"Event Details"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(min(100%, 200px), 1fr))",gap:"clamp(0.75rem,2vw,1rem)"},children:[e.jsx(f,{icon:e.jsx(q,{style:{width:"1em",height:"1em"}}),label:"Event Date",value:v(a.booking_date),color:"#4CAF50"}),a.guest_count&&e.jsx(f,{icon:e.jsx(Ae,{style:{width:"1em",height:"1em"}}),label:"Expected Guests",value:a.guest_count.toString(),color:"#E0C097"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-[clamp(0.5rem,1.5vw,0.75rem)] mb-[clamp(0.75rem,2vw,1.25rem)]",children:[e.jsx("div",{className:"rounded-xl flex items-center justify-center flex-shrink-0",style:{background:"#9C27B020",color:"#9C27B0",width:"clamp(2.25rem,6vw,2.5rem)",height:"clamp(2.25rem,6vw,2.5rem)"},children:e.jsx(he,{style:{width:"45%",height:"45%"}})}),e.jsx("h3",{className:"uppercase tracking-wider text-[clamp(0.875rem,2vw,1.125rem)]",style:{color:"#2A2A2A"},children:"Event Info"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(min(100%, 200px), 1fr))",gap:"clamp(0.75rem,2vw,1rem)"},children:[e.jsx(f,{icon:e.jsx(he,{style:{width:"1em",height:"1em"}}),label:"Event Type",value:n(a.event_type),color:"#9C27B0"}),e.jsx(f,{icon:e.jsx(T,{style:{width:"1em",height:"1em"}}),label:"Time Slot",value:k(a.time_slot),color:"#F4B942"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-[clamp(0.5rem,1.5vw,0.75rem)] mb-[clamp(0.75rem,2vw,1.25rem)]",children:[e.jsx("div",{className:"rounded-xl flex items-center justify-center flex-shrink-0",style:{background:"#FF980020",color:"#FF9800",width:"clamp(2.25rem,6vw,2.5rem)",height:"clamp(2.25rem,6vw,2.5rem)"},children:e.jsx(T,{style:{width:"45%",height:"45%"}})}),e.jsx("h3",{className:"uppercase tracking-wider text-[clamp(0.875rem,2vw,1.125rem)]",style:{color:"#2A2A2A"},children:"Event Timing"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(min(100%, 200px), 1fr))",gap:"clamp(0.75rem,2vw,1rem)"},children:[e.jsx(f,{icon:e.jsx(T,{style:{width:"1em",height:"1em"}}),label:"Start Time",value:a.start_time?w(a.start_time):"â€”",color:"#FF9800"}),e.jsx(f,{icon:e.jsx(T,{style:{width:"1em",height:"1em"}}),label:"End Time",value:a.end_time?w(a.end_time):"â€”",color:"#FF5722"})]})]}),a.special_requests&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-[clamp(0.5rem,1.5vw,0.75rem)] mb-[clamp(0.75rem,2vw,1.25rem)]",children:[e.jsx("div",{className:"rounded-xl flex items-center justify-center flex-shrink-0",style:{background:"#E0C09720",color:"#E0C097",width:"clamp(2.25rem,6vw,2.5rem)",height:"clamp(2.25rem,6vw,2.5rem)"},children:e.jsx(Ge,{style:{width:"45%",height:"45%"}})}),e.jsx("h3",{className:"uppercase tracking-wider text-[clamp(0.875rem,2vw,1.125rem)]",style:{color:"#2A2A2A"},children:"Special Requests"})]}),e.jsx("div",{className:"rounded-2xl border-2",style:{background:"#FAF9F6",borderColor:"#E8E5DB",padding:"clamp(0.75rem,2.5vw,1.5rem)"},children:e.jsx("p",{className:"text-[clamp(0.875rem,1.5vw,1rem)]",style:{color:"#2A2A2A",lineHeight:"1.8"},children:a.special_requests})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-[clamp(0.5rem,1.5vw,0.75rem)] mb-[clamp(0.75rem,2vw,1.25rem)]",children:[e.jsx("div",{className:"rounded-xl flex items-center justify-center flex-shrink-0",style:{background:"#F4B94220",color:"#F4B942",width:"clamp(2.25rem,6vw,2.5rem)",height:"clamp(2.25rem,6vw,2.5rem)"},children:e.jsx(ve,{style:{width:"45%",height:"45%"}})}),e.jsx("h3",{className:"uppercase tracking-wider text-[clamp(0.875rem,2vw,1.125rem)]",style:{color:"#2A2A2A"},children:"Admin Notes (Private)"})]}),e.jsxs("div",{className:"rounded-2xl border-2",style:{background:"#FAF9F6",borderColor:"#E8E5DB",padding:"clamp(0.75rem,2.5vw,1.5rem)"},children:[e.jsx("textarea",{value:p,onChange:r=>J(r.target.value),className:"w-full rounded-xl transition-all duration-200 resize-none text-[clamp(0.875rem,1.5vw,1rem)]",style:{background:"white",border:"2px solid #E8E5DB",color:"#2A2A2A",outline:"none",minHeight:"clamp(100px,15vh,150px)",padding:"clamp(0.5rem,1.5vw,0.75rem) clamp(0.75rem,2vw,1rem)"},placeholder:"Add internal notes like payment details, cancellation reason, follow-up actions...",onFocus:r=>{r.currentTarget.style.borderColor="#C8D46B",r.currentTarget.style.boxShadow="0 4px 12px rgba(200, 212, 107, 0.15)"},onBlur:r=>{r.currentTarget.style.borderColor="#E8E5DB",r.currentTarget.style.boxShadow="none"}}),e.jsx("div",{className:"flex justify-end",style:{marginTop:"clamp(0.75rem,2vw,1rem)"},children:e.jsxs("button",{onClick:Fe,disabled:u,className:"rounded-xl transition-all duration-200 flex items-center gap-[0.5em] disabled:opacity-50 text-[clamp(0.875rem,1.5vw,1rem)]",style:{background:u?"#E8E5DB":"linear-gradient(135deg, #C8D46B, #B5C55A)",color:u?"#666":"white",boxShadow:u?"none":"0 4px 12px rgba(200, 212, 107, 0.3)",padding:"clamp(0.625rem,1.5vw,0.75rem) clamp(1rem,2.5vw,1.5rem)"},children:[e.jsx(ve,{className:"w-[1em] h-[1em]"}),u?"Saving...":"Save Notes"]})})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-[clamp(0.5rem,1.5vw,0.75rem)] mb-[clamp(0.75rem,2vw,1.25rem)]",children:[e.jsx("div",{className:"rounded-xl flex items-center justify-center flex-shrink-0",style:{background:"#4CAF5020",color:"#4CAF50",width:"clamp(2.25rem,6vw,2.5rem)",height:"clamp(2.25rem,6vw,2.5rem)"},children:e.jsx(He,{style:{width:"45%",height:"45%"}})}),e.jsx("h3",{className:"uppercase tracking-wider text-[clamp(0.875rem,2vw,1.125rem)]",style:{color:"#2A2A2A"},children:"Pricing Details"})]}),e.jsx("div",{className:"rounded-2xl border-2",style:{background:"#FAF9F6",borderColor:"#E8E5DB",padding:"clamp(0.75rem,2.5vw,1.5rem)"},children:e.jsxs("div",{style:{display:"grid",gap:"clamp(0.5rem,1.5vw,0.75rem)"},children:[e.jsxs("div",{className:"flex justify-between items-center",style:{padding:"clamp(0.5rem,1.5vw,0.75rem) 0"},children:[e.jsx("span",{className:"text-[clamp(0.875rem,1.5vw,1rem)]",style:{color:"#666"},children:"Package Selected:"}),e.jsx("span",{className:"text-[clamp(0.875rem,1.5vw,1rem)]",style:{color:"#2A2A2A"},children:y?"Loading...":z?.name||"N/A"})]}),e.jsxs("div",{className:"flex justify-between items-center",style:{padding:"clamp(0.5rem,1.5vw,0.75rem) 0",borderTop:"1px solid #E8E5DB"},children:[e.jsx("span",{className:"text-[clamp(0.875rem,1.5vw,1rem)]",style:{color:"#666"},children:"Base Package Price:"}),e.jsxs("span",{className:"text-[clamp(0.875rem,1.5vw,1rem)]",style:{color:"#2A2A2A"},children:["â‚¹",z?.price?.toLocaleString()||"0"]})]}),e.jsxs("div",{className:"flex justify-between items-center",style:{padding:"clamp(0.5rem,1.5vw,0.75rem) 0",borderTop:"1px solid #E8E5DB"},children:[e.jsx("span",{className:"text-[clamp(0.875rem,1.5vw,1rem)]",style:{color:"#666"},children:"Cleaning Charge (Fixed):"}),e.jsxs("span",{className:"text-[clamp(0.875rem,1.5vw,1rem)]",style:{color:"#2A2A2A"},children:["â‚¹",(a.floor_cleaning_cost||3e3).toLocaleString()]})]}),a.status==="confirmed"&&(a.extra_services_total||0)>0&&e.jsxs("div",{className:"flex justify-between items-center",style:{padding:"clamp(0.5rem,1.5vw,0.75rem) 0",borderTop:"1px solid #E8E5DB"},children:[e.jsx("span",{className:"text-[clamp(0.875rem,1.5vw,1rem)]",style:{color:"#666"},children:"Extra Services:"}),e.jsxs("span",{className:"text-[clamp(0.875rem,1.5vw,1rem)]",style:{color:"#2A2A2A"},children:["â‚¹",(a.extra_services_total||0).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between items-center",style:{padding:"clamp(0.75rem,2vw,1rem)",borderTop:"2px solid #E8E5DB",background:"linear-gradient(135deg, rgba(200, 212, 107, 0.1), rgba(181, 197, 90, 0.05))",borderRadius:"12px",marginTop:"clamp(0.5rem,1.5vw,0.75rem)"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[e.jsx("span",{className:"text-[clamp(1rem,2vw,1.25rem)]",style:{color:"#2A2A2A"},children:"Final Price"}),e.jsx("span",{className:"text-[clamp(0.625rem,1.25vw,0.75rem)]",style:{color:"#999",fontStyle:"italic"},children:"(Auto-calculated by server)"})]}),e.jsxs("span",{className:"text-[clamp(1.25rem,2.5vw,1.5rem)]",style:{color:"#C8D46B"},children:["â‚¹",(a.final_price||(z?.price||0)+3e3).toLocaleString()]})]})]})})]}),a.status==="confirmed"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-[clamp(0.5rem,1.5vw,0.75rem)] mb-[clamp(0.75rem,2vw,1.25rem)]",children:[e.jsx("div",{className:"rounded-xl flex items-center justify-center flex-shrink-0",style:{background:"#9C27B020",color:"#9C27B0",width:"clamp(2.25rem,6vw,2.5rem)",height:"clamp(2.25rem,6vw,2.5rem)"},children:e.jsx(we,{style:{width:"45%",height:"45%"}})}),e.jsx("h3",{className:"uppercase tracking-wider text-[clamp(0.875rem,2vw,1.125rem)]",style:{color:"#2A2A2A"},children:"Extra Services"})]}),e.jsxs("div",{className:"rounded-2xl border-2",style:{background:"#FAF9F6",borderColor:"#E8E5DB",padding:"clamp(0.75rem,2.5vw,1.5rem)"},children:[e.jsxs("div",{style:{display:"grid",gap:"clamp(0.75rem,2vw,1rem)",marginBottom:"clamp(1rem,2.5vw,1.5rem)"},children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-[0.5em] text-[clamp(0.75rem,1.5vw,0.875rem)]",style:{color:"#666"},children:"Garbage Bags"}),e.jsx("input",{type:"number",min:"0",value:c,onChange:r=>h(parseInt(r.target.value)||0),className:"w-full rounded-xl transition-all duration-200 text-[clamp(0.875rem,1.5vw,1rem)]",style:{background:"white",border:"2px solid #E8E5DB",color:"#2A2A2A",outline:"none",padding:"clamp(0.5rem,1.5vw,0.75rem) clamp(0.75rem,2vw,1rem)"},onFocus:r=>{r.currentTarget.style.borderColor="#C8D46B",r.currentTarget.style.boxShadow="0 4px 12px rgba(200, 212, 107, 0.15)"},onBlur:r=>{r.currentTarget.style.borderColor="#E8E5DB",r.currentTarget.style.boxShadow="none"}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-[0.5em] text-[clamp(0.75rem,1.5vw,0.875rem)]",style:{color:"#666"},children:"Plates (Small)"}),e.jsx("input",{type:"number",min:"0",value:L,onChange:r=>Q(parseInt(r.target.value)||0),className:"w-full rounded-xl transition-all duration-200 text-[clamp(0.875rem,1.5vw,1rem)]",style:{background:"white",border:"2px solid #E8E5DB",color:"#2A2A2A",outline:"none",padding:"clamp(0.5rem,1.5vw,0.75rem) clamp(0.75rem,2vw,1rem)"},onFocus:r=>{r.currentTarget.style.borderColor="#C8D46B",r.currentTarget.style.boxShadow="0 4px 12px rgba(200, 212, 107, 0.15)"},onBlur:r=>{r.currentTarget.style.borderColor="#E8E5DB",r.currentTarget.style.boxShadow="none"}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-[0.5em] text-[clamp(0.75rem,1.5vw,0.875rem)]",style:{color:"#666"},children:"Plates (Large)"}),e.jsx("input",{type:"number",min:"0",value:ae,onChange:r=>ce(parseInt(r.target.value)||0),className:"w-full rounded-xl transition-all duration-200 text-[clamp(0.875rem,1.5vw,1rem)]",style:{background:"white",border:"2px solid #E8E5DB",color:"#2A2A2A",outline:"none",padding:"clamp(0.5rem,1.5vw,0.75rem) clamp(0.75rem,2vw,1rem)"},onFocus:r=>{r.currentTarget.style.borderColor="#C8D46B",r.currentTarget.style.boxShadow="0 4px 12px rgba(200, 212, 107, 0.15)"},onBlur:r=>{r.currentTarget.style.borderColor="#E8E5DB",r.currentTarget.style.boxShadow="none"}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-[0.5em] text-[clamp(0.75rem,1.5vw,0.875rem)]",style:{color:"#666"},children:"Cooking Gas (kg)"}),e.jsx("input",{type:"number",min:"0",step:"0.5",value:ie,onChange:r=>oe(parseFloat(r.target.value)||0),className:"w-full rounded-xl transition-all duration-200 text-[clamp(0.875rem,1.5vw,1rem)]",style:{background:"white",border:"2px solid #E8E5DB",color:"#2A2A2A",outline:"none",padding:"clamp(0.5rem,1.5vw,0.75rem) clamp(0.75rem,2vw,1rem)"},onFocus:r=>{r.currentTarget.style.borderColor="#C8D46B",r.currentTarget.style.boxShadow="0 4px 12px rgba(200, 212, 107, 0.15)"},onBlur:r=>{r.currentTarget.style.borderColor="#E8E5DB",r.currentTarget.style.boxShadow="none"}})]})]}),e.jsx("div",{className:"rounded-xl border-2",style:{background:"white",borderColor:"#E8E5DB",padding:"clamp(0.75rem,2vw,1rem)",marginBottom:"clamp(1rem,2.5vw,1.5rem)"},children:e.jsxs("div",{style:{display:"grid",gap:"clamp(0.5rem,1.5vw,0.75rem)"},children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-[clamp(0.75rem,1.5vw,0.875rem)]",style:{color:"#666"},children:"Garbage Cost:"}),e.jsxs("span",{className:"text-[clamp(0.875rem,1.5vw,1rem)]",style:{color:"#2A2A2A"},children:["â‚¹",(a.garbage_cost||0).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-[clamp(0.75rem,1.5vw,0.875rem)]",style:{color:"#666"},children:"Plates Cost:"}),e.jsxs("span",{className:"text-[clamp(0.875rem,1.5vw,1rem)]",style:{color:"#2A2A2A"},children:["â‚¹",(a.plates_cost||0).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-[clamp(0.75rem,1.5vw,0.875rem)]",style:{color:"#666"},children:"Gas Cost:"}),e.jsxs("span",{className:"text-[clamp(0.875rem,1.5vw,1rem)]",style:{color:"#2A2A2A"},children:["â‚¹",(a.cooking_gas_cost||0).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between items-center",style:{paddingTop:"clamp(0.5rem,1.5vw,0.75rem)",borderTop:"2px solid #E8E5DB",marginTop:"clamp(0.25rem,1vw,0.5rem)"},children:[e.jsx("span",{className:"text-[clamp(0.875rem,1.5vw,1rem)]",style:{color:"#2A2A2A"},children:"Extra Total:"}),e.jsxs("span",{className:"text-[clamp(1rem,2vw,1.25rem)]",style:{color:"#C8D46B"},children:["â‚¹",(a.extra_services_total||0).toLocaleString()]})]})]})},Be),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:Pe,disabled:I,className:"rounded-xl transition-all duration-200 flex items-center gap-[0.5em] disabled:opacity-50 text-[clamp(0.875rem,1.5vw,1rem)]",style:{background:I?"#E8E5DB":"linear-gradient(135deg, #C8D46B, #B5C55A)",color:I?"#666":"white",boxShadow:I?"none":"0 4px 12px rgba(200, 212, 107, 0.3)",padding:"clamp(0.625rem,1.5vw,0.75rem) clamp(1rem,2.5vw,1.5rem)"},children:[e.jsx(we,{className:"w-[1em] h-[1em]"}),I?"Saving...":"Save Extras"]})})]})]}),e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>Te(!le),className:"flex items-center gap-[clamp(0.5rem,1.5vw,0.75rem)] mb-[clamp(0.75rem,2vw,1.25rem)] w-full hover:opacity-80 transition-opacity",children:[e.jsx("div",{className:"rounded-xl flex items-center justify-center flex-shrink-0",style:{background:"#2196F320",color:"#2196F3",width:"clamp(2.25rem,6vw,2.5rem)",height:"clamp(2.25rem,6vw,2.5rem)"},children:e.jsx(Oe,{style:{width:"45%",height:"45%"}})}),e.jsxs("h3",{className:"uppercase tracking-wider text-[clamp(0.875rem,2vw,1.125rem)] flex-1 text-left",style:{color:"#2A2A2A"},children:["Action History ",le?"â–¼":"â–º"]})]}),le&&e.jsx("div",{className:"rounded-2xl border-2",style:{background:"#FAF9F6",borderColor:"#E8E5DB",padding:"clamp(0.75rem,2.5vw,1.5rem)"},children:Se?e.jsx("div",{className:"text-center py-4",style:{color:"#666"},children:"Loading action history..."}):pe.length===0?e.jsx("div",{className:"text-center py-4",style:{color:"#666"},children:"No actions recorded yet"}):e.jsx("div",{style:{display:"grid",gap:"clamp(0.75rem,2vw,1rem)"},children:pe.map((r,m)=>{const Y=lr(r);return e.jsxs("div",{className:"rounded-xl border",style:{padding:"clamp(0.75rem,2vw,1rem)",borderColor:"#E8E5DB",background:m===0?"rgba(200, 212, 107, 0.05)":"white"},children:[e.jsx("div",{className:"flex justify-between items-start gap-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-[clamp(0.875rem,1.5vw,1rem)] mb-1",style:{color:"#2A2A2A",lineHeight:"1.5"},children:Y}),e.jsx("span",{className:"text-[clamp(0.75rem,1.5vw,0.875rem)]",style:{color:"#999"},children:new Date(r.performed_at).toLocaleString()})]})}),r.notes&&e.jsxs("div",{className:"text-[clamp(0.875rem,1.5vw,1rem)] mt-3 pt-3 border-t",style:{color:"#666",borderColor:"#E8E5DB",fontStyle:"italic"},children:["Note: ",r.notes]})]},r.id)})})})]})]})}),e.jsx("div",{className:"border-t-2",style:{borderColor:"#E8E5DB",background:"#FAF9F6",padding:"clamp(0.75rem,2.5vw,1.5rem) clamp(1rem,4vw,2rem)"},children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-[clamp(0.5rem,1.5vw,0.75rem)]",children:[a.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:De,disabled:B.isPending,className:"flex-1 rounded-xl transition-all duration-200 flex items-center justify-center gap-[0.5em] disabled:opacity-50 disabled:cursor-not-allowed text-[clamp(0.875rem,1.5vw,1rem)]",style:{background:"linear-gradient(135deg, #4CAF50, #45A049)",color:"white",boxShadow:"0 4px 12px rgba(76, 175, 80, 0.3)",padding:"clamp(0.75rem,2vw,1rem) clamp(1rem,2.5vw,1.5rem)"},children:[e.jsx(fe,{className:"w-[1.25em] h-[1.25em]"}),e.jsx("span",{className:"font-medium",children:"Confirm Booking"})]}),e.jsxs("button",{onClick:()=>i(a),className:"flex-1 rounded-xl transition-all duration-200 flex items-center justify-center gap-[0.5em] text-[clamp(0.875rem,1.5vw,1rem)]",style:{background:"white",border:"2px solid #E57373",color:"#E57373",padding:"clamp(0.75rem,2vw,1rem) clamp(1rem,2.5vw,1.5rem)"},onMouseEnter:r=>{r.currentTarget.style.background="#E57373",r.currentTarget.style.color="white"},onMouseLeave:r=>{r.currentTarget.style.background="white",r.currentTarget.style.color="#E57373"},children:[e.jsx(je,{className:"w-[1.25em] h-[1.25em]"}),e.jsx("span",{className:"font-medium",children:"Reject"})]})]}),a.status==="confirmed"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>d(a.id,"completed"),disabled:B.isPending,className:"flex-1 rounded-xl transition-all duration-200 flex items-center justify-center gap-[0.5em] disabled:opacity-50 disabled:cursor-not-allowed text-[clamp(0.875rem,1.5vw,1rem)]",style:{background:"linear-gradient(135deg, #E0C097, #C29A5D)",color:"white",boxShadow:"0 4px 12px rgba(224, 192, 151, 0.3)",padding:"clamp(0.75rem,2vw,1rem) clamp(1rem,2.5vw,1.5rem)"},children:[e.jsx(te,{className:"w-[1.25em] h-[1.25em]"}),e.jsx("span",{className:"font-medium",children:"Mark Completed"})]}),e.jsxs("button",{onClick:()=>i(a),className:"flex-1 rounded-xl transition-all duration-200 flex items-center justify-center gap-[0.5em] text-[clamp(0.875rem,1.5vw,1rem)]",style:{background:"white",border:"2px solid #E57373",color:"#E57373",padding:"clamp(0.75rem,2vw,1rem) clamp(1rem,2.5vw,1.5rem)"},onMouseEnter:r=>{r.currentTarget.style.background="#E57373",r.currentTarget.style.color="white"},onMouseLeave:r=>{r.currentTarget.style.background="white",r.currentTarget.style.color="#E57373"},children:[e.jsx(Ce,{className:"w-[1.25em] h-[1.25em]"}),e.jsx("span",{className:"font-medium",children:"Cancel Booking"})]})]}),a.status==="cancelled"&&e.jsxs("button",{onClick:()=>g(a),className:"flex-1 rounded-xl transition-all duration-200 flex items-center justify-center gap-[0.5em] text-[clamp(0.875rem,1.5vw,1rem)]",style:{background:"white",border:"2px solid #999",color:"#999",padding:"clamp(0.75rem,2vw,1rem) clamp(1rem,2.5vw,1.5rem)"},onMouseEnter:r=>{r.currentTarget.style.background="#FF3333",r.currentTarget.style.borderColor="#FF3333",r.currentTarget.style.color="white"},onMouseLeave:r=>{r.currentTarget.style.background="white",r.currentTarget.style.borderColor="#999",r.currentTarget.style.color="#999"},children:[e.jsx(Ve,{className:"w-[1.25em] h-[1.25em]"}),e.jsx("span",{className:"font-medium",children:"Delete Permanently"})]}),a.status==="completed"&&e.jsx("div",{className:"flex-1 text-center",style:{padding:"clamp(0.75rem,2vw,1rem)"},children:e.jsxs("div",{className:"flex items-center justify-center gap-[0.5em] text-[clamp(0.875rem,1.5vw,1rem)]",style:{color:"#4CAF50"},children:[e.jsx(te,{className:"w-[1.25em] h-[1.25em]"}),e.jsx("span",{className:"font-medium",children:"Event Completed Successfully"})]})})]})})]})})}function f({icon:a,label:t,value:d,color:i,span:g}){return e.jsx("div",{className:`rounded-2xl ${g||""}`,style:{background:"#F5F3EE",padding:"clamp(0.75rem,2vw,1rem)"},children:e.jsxs("div",{className:"flex items-center gap-[clamp(0.5rem,1.5vw,0.75rem)]",children:[e.jsx("div",{className:"rounded-xl flex items-center justify-center flex-shrink-0 text-[clamp(0.875rem,1.5vw,1rem)]",style:{background:`${i}20`,color:i,width:"2.5em",height:"2.5em"},children:a}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-[clamp(0.7rem,1.25vw,0.75rem)] mb-[0.25em]",style:{color:"#999"},children:t}),e.jsx("div",{className:"truncate text-[clamp(0.875rem,1.5vw,1rem)]",style:{color:"#2A2A2A"},children:d})]})]})})}function ye({title:a,message:t,confirmText:d,cancelText:i,onConfirm:g,onCancel:v,isDangerous:w}){return e.jsx(E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 flex items-center justify-center",style:{background:"rgba(0, 0, 0, 0.6)",backdropFilter:"blur(8px)",zIndex:9999,padding:"clamp(1rem,4vw,2rem)"},onClick:v,children:e.jsxs(E.div,{initial:{scale:.95,y:20},animate:{scale:1,y:0},exit:{scale:.95,y:20},className:"rounded-3xl",style:{background:"white",boxShadow:"0 20px 60px rgba(0,0,0,0.2)",width:"100%",maxWidth:"min(28rem, 95vw)",padding:"clamp(1.5rem,4vw,2rem)"},onClick:n=>n.stopPropagation(),children:[e.jsx("div",{className:"mx-auto mb-[1.5em] rounded-2xl flex items-center justify-center",style:{background:w?"linear-gradient(135deg, #E57373, #EF5350)":"linear-gradient(135deg, #C8D46B, #B5C55A)",color:"white",width:"clamp(4rem,12vw,5rem)",height:"clamp(4rem,12vw,5rem)"},children:e.jsx(Ee,{style:{width:"50%",height:"50%"}})}),e.jsx("h3",{className:"text-center mb-[0.75em] text-[clamp(1.25rem,3vw,1.75rem)]",style:{color:"#2A2A2A"},children:a}),e.jsx("p",{className:"text-center mb-[2em] text-[clamp(0.875rem,1.5vw,1rem)]",style:{color:"#666",lineHeight:"1.6"},children:t}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-[clamp(0.5rem,1.5vw,0.75rem)]",children:[e.jsx("button",{onClick:v,className:"flex-1 rounded-xl transition-all duration-200 text-[clamp(0.875rem,1.5vw,1rem)]",style:{background:"#F5F3EE",color:"#666",padding:"clamp(0.75rem,2vw,1rem) clamp(1rem,2.5vw,1.5rem)"},children:i}),e.jsx("button",{onClick:g,className:"flex-1 rounded-xl transition-all duration-200 text-[clamp(0.875rem,1.5vw,1rem)]",style:{background:w?"linear-gradient(135deg, #E57373, #EF5350)":"linear-gradient(135deg, #C8D46B, #B5C55A)",color:"white",boxShadow:w?"0 4px 12px rgba(229, 115, 115, 0.3)":"0 4px 12px rgba(200, 212, 107, 0.3)",padding:"clamp(0.75rem,2vw,1rem) clamp(1rem,2.5vw,1.5rem)"},children:d})]})]})})}export{hr as AdminBookings,hr as default};
