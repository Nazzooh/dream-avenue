import{o as m,a as o,n as i,h as p,i as y,l as k,s as n,b as g,u as l,c as u}from"./index-DCvhesIs.js";import{t}from"./vendor-ui-Bvf1z7Qk.js";const c=m({id:o().uuid().optional(),name:o().min(1,"Package name is required"),price:i().min(0,"Price must be positive").optional().nullable(),price_min:i().min(0,"Price must be positive").optional().nullable(),price_max:i().min(0,"Price must be positive").optional().nullable(),description:o().optional().nullable(),features:y(o()).optional().default([]),max_guests:i().int().positive("Max guests must be positive").optional().nullable(),image_url:o().optional().or(k("")).nullable(),is_featured:p().optional().default(!1),is_active:p().optional().default(!0),order_index:i().int().optional().nullable(),created_at:o().optional(),updated_at:o().optional()}),f=c.omit({id:!0,created_at:!0,updated_at:!0});f.partial();const P=async()=>{const{data:a,error:e}=await n.from("packages").select("*").eq("is_active",!0).order("order_index",{ascending:!0});if(e)throw new Error(e.message);return c.array().parse(a||[])},w=async()=>{const{data:a,error:e}=await n.from("packages").select("*").order("order_index",{ascending:!0});if(e)throw new Error(e.message);return c.array().parse(a||[])},b=async a=>{const{data:e,error:s}=await n.from("packages").insert([a]).select().single();if(s)throw new Error(s.message);return c.parse(e)},q=async(a,e)=>{const{data:s,error:d}=await n.from("packages").update(e).eq("id",a).select().single();if(d)throw new Error(d.message);return c.parse(s)},_=async a=>{const{error:e}=await n.from("packages").delete().eq("id",a);if(e)throw new Error(e.message)},v=async a=>{const{error:e}=await n.rpc("update_package_order",{updates:a});if(e)throw new Error(`Failed to update package order: ${e.message}`)},r={all:["packages"],lists:()=>[...r.all,"list"],list:a=>[...r.lists(),a],details:()=>[...r.all,"detail"],detail:a=>[...r.details(),a]},h=()=>g({queryKey:r.lists(),queryFn:P}),K=()=>g({queryKey:[...r.all,"admin"],queryFn:w}),x=()=>{const a=l();return u({mutationFn:e=>b(e),onSuccess:()=>{a.invalidateQueries({queryKey:r.all}),t.success("Package created successfully")},onError:e=>{t.error(e.message||"Failed to create package")}})},C=()=>{const a=l();return u({mutationFn:({id:e,data:s})=>q(e,s),onSuccess:(e,s)=>{a.invalidateQueries({queryKey:r.all}),a.invalidateQueries({queryKey:r.detail(s.id)}),t.success("Package updated successfully")},onError:e=>{t.error(e.message||"Failed to update package")}})},Q=()=>{const a=l();return u({mutationFn:e=>_(e),onSuccess:()=>{a.invalidateQueries({queryKey:r.all}),t.success("Package deleted successfully")},onError:e=>{t.error(e.message||"Failed to delete package")}})},S=()=>{const a=l();return u({mutationFn:e=>v(e),onSuccess:()=>{a.invalidateQueries({queryKey:r.all}),t.success("✅ Package order updated successfully")},onError:e=>{t.error(e.message||"❌ Failed to update package order")}})};export{S as a,K as b,x as c,C as d,Q as e,h as u};
