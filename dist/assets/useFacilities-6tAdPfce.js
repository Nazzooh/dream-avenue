import{o as d,a as s,h as y,s as l,b as p,u as n,c as u}from"./index-DCvhesIs.js";import{t as r}from"./vendor-ui-Bvf1z7Qk.js";const o=d({id:s().uuid().optional(),title:s().min(1,"Facility title is required"),description:s().optional().nullable(),icon:s().optional().nullable(),image_url:s().optional().nullable(),image:s().optional().nullable(),is_active:y().optional().default(!0),created_at:s().optional()}),f=o.omit({id:!0,created_at:!0});f.partial();const g=async()=>{console.log("ðŸ¢ Fetching facilities via direct Supabase...");const{data:a,error:e}=await l.from("facilities").select("*").eq("is_active",!0).order("created_at",{ascending:!1});if(e)throw console.error("âŒ Supabase error:",e),new Error(e.message);return console.log("âœ… Facilities loaded:",a?.length||0),o.array().parse(a||[])},m=async a=>{console.log("âž• Creating facility via direct Supabase...");const{data:e,error:t}=await l.from("facilities").insert([a]).select().single();if(t)throw console.error("âŒ Supabase error:",t),new Error(t.message);return console.log("âœ… Facility created:",e?.id),o.parse(e)},F=async(a,e)=>{console.log("âœï¸ Updating facility via direct Supabase:",a);const{data:t,error:c}=await l.from("facilities").update(e).eq("id",a).select().single();if(c)throw console.error("âŒ Supabase error:",c),new Error(c.message);return console.log("âœ… Facility updated:",t?.id),o.parse(t)},b=async a=>{console.log("ðŸ—‘ï¸ Deleting facility via direct Supabase:",a);const{error:e}=await l.from("facilities").delete().eq("id",a);if(e)throw console.error("âŒ Supabase error:",e),new Error(e.message);console.log("âœ… Facility deleted:",a)},i={all:["facilities"],lists:()=>[...i.all,"list"],list:a=>[...i.lists(),a],details:()=>[...i.all,"detail"],detail:a=>[...i.details(),a]},w=()=>p({queryKey:i.lists(),queryFn:g}),v=()=>{const a=n();return u({mutationFn:e=>m(e),onSuccess:()=>{a.invalidateQueries({queryKey:i.all}),r.success("Facility created successfully")},onError:e=>{r.error(e.message||"Failed to create facility")}})},h=()=>{const a=n();return u({mutationFn:({id:e,data:t})=>F(e,t),onSuccess:(e,t)=>{a.invalidateQueries({queryKey:i.all}),a.invalidateQueries({queryKey:i.detail(t.id)}),r.success("Facility updated successfully")},onError:e=>{r.error(e.message||"Failed to update facility")}})},C=()=>{const a=n();return u({mutationFn:e=>b(e),onSuccess:()=>{a.invalidateQueries({queryKey:i.all}),r.success("Facility deleted successfully")},onError:e=>{r.error(e.message||"Failed to delete facility")}})};export{v as a,h as b,C as c,w as u};
